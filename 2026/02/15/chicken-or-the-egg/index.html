
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://infrabytes.dev/2026/02/15/chicken-or-the-egg/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../../../assets/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Chicken or the Egg? - infrabytes</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chicken-or-the-egg" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="infrabytes" class="md-header__button md-logo" aria-label="infrabytes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            infrabytes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chicken or the Egg?
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="infrabytes" class="md-nav__button md-logo" aria-label="infrabytes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    infrabytes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About Me
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2026/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2026
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-vendor-lock-in-dilemma" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Vendor Lock-in Dilemma
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-helm-crd-upgrade-problem" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Helm CRD Upgrade Problem
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-hybrid-approach-using-terragrunt-and-helm" class="md-nav__link">
    <span class="md-ellipsis">
      
        A Hybrid Approach using Terragrunt and Helm
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A Hybrid Approach using Terragrunt and Helm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#an-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        An example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nelm-as-an-alternative-to-helm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nelm as an Alternative to Helm
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../.." class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2026-02-15 00:00:00+00:00" class="md-ellipsis">February 15, 2026</time>
                      </div>
                    </li>
                    
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              6 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  




<h1 id="chicken-or-the-egg">Chicken or the Egg?</h1>
<!-- more -->

<p>When it comes to bootstrapping and managing Kubernetes clusters on public cloud platforms such as AWS and Azure, there seems to be a few schools of thought, especially when it comes to using Infrastructure as Code. While it's possible to deploy and manage everything manually through their respective consoles, teams will most likely want instead to use IaC and have version controlled code that can deploy and upgrade their clusters. </p>
<h2 id="the-vendor-lock-in-dilemma">The Vendor Lock-in Dilemma</h2>
<p>AWS, for example, provides <a href="https://docs.aws.amazon.com/eks/latest/eksctl/what-is-eksctl.html">eksctl</a> for this purpose. While it might save you some time in terms of writing your own <a href="https://developer.hashicorp.com/terraform">Terraform</a>/<a href="https://opentofu.org/">OpenTofu</a> code in the beginning, you'll have to learn a tool that only works for AWS EKS, which is a situation that I always try to avoid myself. Why purposefully invest my time into a tool that will inevitably bring us one step closer to vendor-locking us into one cloud platform? If you are already working with public cloud platforms, you are already most likely working with Terraform, so I personally don't see the need to add <em>yet another</em> tool on top.</p>
<p>I have seen some people prefer to stay as Kubernetes-native as possible, and use tools such as <a href="https://www.crossplane.io/">Crossplane</a>, <a href="https://aws-controllers-k8s.github.io/docs/intro">ACK</a> or <a href="https://azure.github.io/azure-service-operator/">ASO</a> to deploy and manage multiple clusters - all of which already require you to <em>already</em> have a functioning Kubernetes cluster to begin with. I still think that these are wonderful tools that I use, but I wouldn't use them to manage Kubernetes clusters, but to rather build components for developers to use which require the creation of public cloud resources outside of the cluster instead. You could also say that I have an unshakable fear of not seeing what will get changed when I apply resources using Crossplane, unlike Terraform, on such crucial pieces of infrastructure in production.</p>
<h2 id="the-helm-crd-upgrade-problem">The Helm CRD Upgrade Problem</h2>
<p>And after you have bootstrapped your cluster, you will most likely want to install <a href="https://helm.sh/">Helm</a> charts - this could be anything from <a href="https://karpenter.sh/">Karpenter</a>, to provide smart auto-scaling for your cluster, to <a href="https://docs.github.com/en/actions/concepts/runners/actions-runner-controller">GitHub ARC</a>, which provides you with self-hosted scale set runners for GitHub Actions. You can install your Helm charts using the <a href="https://registry.terraform.io/providers/hashicorp/helm/latest/docs">Terraform Helm provider</a>, but after the initial bootstrapping of your cluster, when it comes to upgrading the Helm charts in your cluster, you will painfully learn the important lesson that Helm does <em>not</em> upgrade CRDs for you, besides <a href="https://helm.sh/docs/chart_best_practices/custom_resource_definitions/">installing CRDs on an initial installation</a>.</p>
<p>In addition, when it comes to bootstrapping a cluster from scratch <em>and</em> installing Helm charts or Kubernetes manifests to the cluster, you will quickly realize that it is not possible to do it all in one Terraform project. For example, for the Terraform Kubernetes provider and the Helm provider, you'll need to point the provider to your cluster credentials, which do not exist yet. Or, if you are installing a resource that expects a CRD to already exist, then Terraform will fail in the planning phase. This is a common challange with declarative IaC tools, and not just purely a Terraform issue.</p>
<p>To give a more concrete example, suppose that you want to install <a href="https://cert-manager.io/">cert-manager</a> and also install your cert-manager manifests, such as <code>ClusterIssuer</code> and <code>Certificate</code> in one go. If you put it all in one Terraform project, it will fail, because when you try to create a <code>ClusterIssuer</code> without cert-manager already being installed, Terraform will fail, saying that there is no such resource type in the cluster.</p>
<p>It seems to me that working as a Kubernetes cluster administrator is an almost unending question of "Which came first - the chicken, or the egg?". </p>
<p>In my time of researching for how people have tried to solve these issues, I have not yet found one universal, one-size-fits-all solution that I can also recommend in a production capacity. </p>
<h2 id="a-hybrid-approach-using-terragrunt-and-helm">A Hybrid Approach using Terragrunt and Helm</h2>
<p>When it comes to the Terraform problem of having to split your project into multiple Terraform projects, I have found that the best solution is to indeed split it up into multiple projects - however, instead of keeping purely Terraform, I prefer to use <a href="https://terragrunt.gruntwork.io/">Terragrunt</a>. It is a very powerful wrapper tool for Terraform/OpenTofu that adds the ability to deploy multiple Terraform projects that depend one another using a Directed Acrylic Graph(DAG)<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>, which ensures that Terraform modules are installed in the correct order. One small downside of this type of deployment is that for subsequent Terraform modules after the initial one, you cannot get a proper Terraform plan output, for which using mock input values becomes necessary.</p>
<p>What about when it comes to managing your CRDs for your Helm charts? While there are numerous methods available, there seems to be no single one solution that works for all charts. Karpenter, for example, provides a separate chart for managing the CRDs, which you can then upgrade before upgrading your main Karpenter chart. Some charts recommend that you manually upgrade the new CRDs before upgrading your chart, if there are breaking changes. Some charts, such as <a href="https://kyverno.io/">Kyverno</a>, use Helm hooks for post-installation that upgrade your CRDs for you. GitHub ARC, on the other hand, recommends that you<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup>:</p>
<ul>
<li>Uninstall all existing scale sets</li>
<li>Uninstall ARC</li>
<li>Delete all CRDs, if the CRDs need to be upgraded (this is often the case)</li>
<li>Reinstall ARC</li>
<li>Reinstall your scale sets</li>
</ul>
<p>This process is error-prone and disruptive, especially in production environments with numerous scale sets. As you can see, the situation can become an absolute mess to manage long-term, especially when you are installing dozens of these charts into your cluster. Every cluster upgrade can become a nightmare of going through all the release notes of your charts, noting breaking changes, preparing, testing on a staging cluster, and crossing your fingers when the time comes to upgrade your production cluster.</p>
<p>When it comes to the Terraform solution, I have yet again seen that there is no one agreed upon solution online. Some publicly available, and very popular, Terraform modules simply seem to ignore this problem. They just install the Helm chart using the <code>helm_release</code> resource type in Terraform, which will work great on a first time installation. But what happens when you use the same module to upgrade your pre-existing installation? Some Terraform modules that have put more thought into this, use the <code>helm_template</code> data block for Terraform to render out the Kubernetes manifests, which would also update the CRDs. But what about Helm charts that also use pre/post-installation hooks and similar, which would then not be a part of the <code>helm template</code>? The same problem exists for the very popular <a href="https://argo-cd.readthedocs.io/en/stable/user-guide/helm/">ArgoCD</a>, which can also install Helm charts, but installs them using <code>helm template</code> and not installing them using native Helm. </p>
<p>While I still think that there is still no universal solution to upgrading Helm charts, I think the closest to it would be to:</p>
<ul>
<li>Use <code>helm_template</code> to render out the chart, but only the CRDs</li>
<li>Apply those CRDs to the cluster using Terraform</li>
<li>Use <code>helm_release</code> to install the chart while skipping CRD installation</li>
</ul>
<h3 id="an-example">An example</h3>
<div class="language-hcl highlight"><pre><span></span><code><span class="c1"># Render and install CRDs</span>
<span class="kr">data</span><span class="w"> </span><span class="nc">&quot;helm_template&quot;</span><span class="w"> </span><span class="nv">&quot;chart_crds&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">name</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my-chart&quot;</span>
<span class="w">  </span><span class="na">repository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://charts.example.com&quot;</span>
<span class="w">  </span><span class="na">chart</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my-chart&quot;</span>
<span class="w">  </span><span class="na">version</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;1.2.3&quot;</span>
<span class="w">  </span><span class="na">include_crds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<span class="w">  </span><span class="na">skip_templates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<span class="w">  </span><span class="na">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="nf">file</span><span class="p">(</span><span class="s2">&quot;${path.module}/values.yaml&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>

<span class="nb">locals</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nb">crds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">for</span><span class="w"> </span><span class="err">k</span><span class="p">,</span><span class="w"> </span><span class="err">v</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="nv">data.helm_template.chart_crds.manifests</span><span class="w"> </span><span class="p">:</span>
<span class="w">    </span><span class="na">k</span><span class="w"> </span><span class="o">=</span><span class="err">&gt;</span><span class="w"> </span><span class="err">v</span>
<span class="w">    </span><span class="err">if</span><span class="w"> </span><span class="err">str</span><span class="nf">contains</span><span class="p">(</span><span class="err">v</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;kind: CustomResourceDefinition&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;kubernetes_manifest&quot;</span><span class="w"> </span><span class="nv">&quot;crds&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">for_each</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">local.crds</span>
<span class="w">  </span><span class="na">manifest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">yamldecode</span><span class="p">(</span><span class="nv">each.value</span><span class="p">)</span>
<span class="p">}</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;kubectl_manifest&quot;</span><span class="w"> </span><span class="nv">&quot;chart_crds&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nb">for_each</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">crd</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="nv">data.helm_template.chart_crds.crds</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nv">crd.metadata.name</span><span class="w"> </span><span class="p">=</span><span class="err">&gt;</span><span class="w"> </span><span class="err">crd</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="na">yaml_body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">each.value</span>
<span class="p">}</span>

<span class="c1"># Install the Helm chart</span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;helm_release&quot;</span><span class="w"> </span><span class="nv">&quot;my_chart&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">name</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my-chart&quot;</span>
<span class="w">  </span><span class="na">repository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://charts.example.com&quot;</span>
<span class="w">  </span><span class="na">chart</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my-chart&quot;</span>
<span class="w">  </span><span class="na">version</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;1.2.3&quot;</span>
<span class="w">  </span><span class="na">namespace</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;default&quot;</span>
<span class="w">  </span><span class="na">skip_crds</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>

<span class="w">  </span><span class="na">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="nf">file</span><span class="p">(</span><span class="s2">&quot;${path.module}/values.yaml&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">]</span>

<span class="w">  </span><span class="na">depends_on</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nv">kubectl_manifest.chart_crds</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="nelm-as-an-alternative-to-helm">Nelm as an Alternative to Helm</h2>
<p>In addition, there is <a href="https://github.com/werf/nelm">nelm</a>, from the makers of <a href="https://werf.io/">werf</a>, which promises to be a faster moving and improved Helm alternative, which also provides improved CRD management, among other improvements.<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup> However, I'm still a little wary of bringing it into production as our workflows are so heavily Terraform dependent, and there is no official provider to use it within Terraform. Nelm is a promising alternative, but as of early 2026, it does not seem to be widely adopted in production environments. </p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="https://helm.sh/docs/chart_best_practices/custom_resource_definitions/">Helm - Custom Resource Definitions</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="https://terragrunt.gruntwork.io/docs/features/run-queue/">Terragrunt - Run Queue</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p><a href="https://docs.github.com/en/actions/tutorials/use-actions-runner-controller/deploy-runner-scale-sets#upgrading-arc">GitHub Actions - Upgrading ARC</a>&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p><a href="https://github.com/werf/nelm?tab=readme-ov-file#improved-crd-management">Nelm - Improved CRD management</a>&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  




  



      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/bbayrakt" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.linkedin.com/in/berk-bayraktar-82227b17/" target="_blank" rel="noopener" title="LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["content.code.copy"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>